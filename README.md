# A how-to on Java Flight Recorder  
  
## Anatomy of a JFR Event  
A JFR event is a small data blob containing:  
  
Event ID:  Unique identifier  
Timestamp (CPU ticks):  Time of the event  
Duration (CPU ticks):  Event duration (not all events have this, e.g., instant events)  
Thread ID:  ID of the thread generating the event; not all events are tied to a thread so not all events have a thread ID  
StackTrace ID:  StackTraces are stored separately, stacktrace IDs are stored with the event  
Event specific payload:  Specific data points for the event, as defined in the event declaration. Refer src/main/java/com/sxnamit/jfr/event/TransactionCommitEvent.java  
  
### Custom event declaration  
```
import jdk.jfr.Event;

// minimal fields to prevent jfr recording bloat
class OrderEvent extends Event {
  public int orderId;
}

void placeOrder() {
  OrderEvent e = new OrderEvent();
  e.begin(); // captures the event start timestamp

  // *** important work profiled by the event ***
  e.orderId = 123; // order ID generated by the code profiled above

  e.end(); // captures the event end timestamp
  e.commit(); // calls end() implicitly, so end() call is optional
}
```
  
P.S:  
Here is some other relevant useful info on the topic -  
Intro vids  
https://www.youtube.com/watch?v=plYESjZ12hM  
https://www.youtube.com/watch?v=AgFOJEkBVjg  
  
JDK tools to work with jfr  
https://docs.oracle.com/en/java/javase/21/docs/specs/man/jcmd.html  
https://docs.oracle.com/en/java/javase/21/docs/specs/man/jfr.html  
  
Javadoc  
https://docs.oracle.com/en/java/javase/21/docs/api/jdk.jfr/module-summary.html  
  
JFR API guide  
https://docs.oracle.com/en/java/javase/21/jfapi/index.html  
  
Additional links  
https://docs.oracle.com/en/java/javase/21/troubleshoot/index.html  
https://inside.java/tag/jfr  
https://developers.redhat.com/blog/2020/08/25/get-started-with-jdk-flight-recorder-in-openjdk-8u#about_jdk_flight_recorder  
  
JFR Event Collection for JDK 21
https://sap.github.io/SapMachine/jfrevents/21.html  
